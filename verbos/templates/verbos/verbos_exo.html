{% extends 'verbos/layout.html' %}


{% block jsscript %}

	<script>
		function addletter(letter) {
			document.getElementById('myrespuesta').value = document.getElementById('myrespuesta').value + letter;
		}

		
		
		
		initlocal({{ jstiempos | safe }} ); 
		initlocal({{ jspronombres  | safe }} ); 
		initlocal({{ jsverbotipos | safe }} ); 
		initlocal({{ jslevels | safe }} ); 



		document.addEventListener('DOMContentLoaded',function() {
			// load des status checks precedement chargés dans le stockage local 
			checklocal( {{ jstiempos | safe }} );
			checklocal ( {{ jspronombres | safe }} );
			checklocal ( {{ jsverbotipos | safe }} );
			checklocal ( {{ jslevels     | safe }} );

			// gestions des events 
			//1) event sur la mise a jour de slect All 
			// ici on selectionne tous les form input dont le name est checktodos
			document.querySelectorAll('input[name="checktodos"]').forEach(function(checkheader) {
				// pour chaque item touvé on applique un event lors d'un event de changement sur l'item 
				checkheader.onchange = function() {
					// on recupere le data-type de l'item trouvé : celui sert à identifier les sous item via leur name 
					type=checkheader.dataset["type"];
					// on selectione tous les item dont le name  vaut la valeur de type 
					bloc=document.querySelectorAll('input[name=' + type + ']');
					// on boucle sur tous les items trouvés pour assigner le status check a celui du header 
					for ( var i=0 ; i < bloc.length ; i++ ) {
						// on teste que le sous item est bien une checkbox 
						if ( bloc[i].type = "checkbox") { 
							// on assigne la valeur du header 
							bloc[i].checked = checkheader.checked;
							localStorage.setItem(bloc[i].id,checkheader.checked);
						} 
					}
				}
			});
			//2) ici  on clique sur une des checkbox : on met à jour la variable locale 
			document.querySelectorAll('[data-storage]').forEach(function(checkbox) {
				checkbox.onchange = function() {
			//		console.log(" checkbox cliquée " + checkbox.id );
					localStorage.setItem(checkbox.id,checkbox.checked);
				}
			});
			//3) ici on gere le clique sur un bouton lettre pour ajouter cette lettre à la réponse 
			document.querySelectorAll('[data-letter]').forEach(function(letter) { 
				letter.onclick = function() { 
					console.log("letter cliqué" + letter.id ) ; 
					document.getElementById('myrespuesta').value = document.getElementById('myrespuesta').value + letter.dataset["letter"];
					console.log("nouvelle value" + document.getElementById('myrespuesta').value ) ; 

				}
			});

		});

	</script>




{%  endblock %}





{% block body1 %} 

<form action= "{% url 'verbos_exo_run'  1 conjugacion_selectada.id %}"  method="post"> 
{% csrf_token %}
{{conjugacion_selectada.tiempo}}
{{conjugacion_selectada.verbo}}
{{conjugacion_selectada.pronombre }}
<br> 
<label for="your_name"> Cual es la conjugacion ? </label> 
	<input autofocus id="myrespuesta" type="text" name="respuesta" >
	<input type="submit" value="Submit">    
	</input> 
	{{tiempos_checked}}
<br>
<span type="text" id="lettre-a" onclick="addletter('á')" value="á" > á </span>    
<span type="text" id="lettre-i" onclick="addletter('í')" value="í" > í </span>    
<span type="text" id="lettre-o" onclick="addletter('ó')" value="ó" > ó </span>    
{{conjugacion_selectada.id}}
{{conjugacion_selectada.id}}
{{conjugacion_selectada.tiempo}}
{{conjugacion_selectada.verbo}}
{{conjugacion_selectada.pronombre }}
{{conjugacion_selectada.conjugacion}}
{{conjugacion_selectada_count }}
loto_winner {{loto_winner }}
pk-winner {{pk_winner  }}
<br> Resuelto : {{ resuelto }}
<br> trace : {{trace}} 

<div id="container"> 
	<div> 
	<input type="checkbox" id="checkbox_tiempo"   name="checktodos"  data-type="tiempo" >
	<label for="checkbox_tiempo"> Select all   </label>
	<br>
	{% for tiempo  in tiempos %} 
	<input type="checkbox" id="Tiempo-{{tiempo.id}}" name="tiempo" data-storage="true" value="{{tiempo.id}}"  {{ tiempo.checked }} >
	<label for="Tiempo-{{tiempo.id}}"> {{tiempo}}    </label>
	<br>
	{% endfor %} 
	</div> 


	<div> 
		<input type="checkbox" id="checkbox_pronombre"   name="checktodos"   data-type="pronombre" >
	<label for="checkbox_pronombre"> Select all  </label>
	<br>
	{% for pronombre   in pronombres %} 
	<input type="checkbox" id="Pronombre-{{pronombre.id}}" name="pronombre" data-storage="true" value="{{pronombre.id }}" {{pronombre.checked}} >
	<label for="Pronombre-{{pronombre.id}}"> {{pronombre}}   </label>
	<br>
	{% endfor %} 
	</div> 


  	<div> 
		<input type="checkbox" id="checkbox_verbotipo"   name="checktodos"   data-type="verbotipo" >
	<label for="checkbox_verbotipo"> Select all  </label>
	<br>
	{% for verbotipo   in verbotipos %} 
	<input type="checkbox" id="Verbotipo-{{verbotipo.id}}" name="verbotipo" data-storage="true" value="{{verbotipo.id }}"  {{verbotipo.checked}} >
	<label for="Verbotipo-{{verbotipo.id}}"> {{verbotipo}}   </label>
	<br>
	{% endfor %} 
	</div> 
   


  	<div> 
		<input type="checkbox" id="checkbox_level"   name="checktodos"   data-type="level" >
	<label for="checkbox_verbotipo"> Select all  </label>
	<br>
	{% for level   in levels %} 
	<input type="checkbox" id="Level-{{level.id}}" name="level" data-storage="true" value="{{level.id }}"  {{level.checked}} >
	<label for="Level-{{level.id}}"> {{level}}   </label>
	<br>
	{% endfor %} 
	</div> 
	</div> 
<form>
{% endblock %}

